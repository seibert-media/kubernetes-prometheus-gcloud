ALERT DiskOutOfSpace
  IF (max(diskstatus_bytesfree / diskstatus_bytestotal) BY (app)) < 0.2
  FOR 1m
  LABELS {severity="warning"}
  ANNOTATIONS {
    summary="Disk of {{ $labels.app }} space",
    description="{{ $labels.app }} is below 20% free space for more than 1 minutes.", 
  }

ALERT DiskOutOfSpace
  IF (max(diskstatus_bytesfree / diskstatus_bytestotal)BY (app)) < 0.1
  FOR 1m
  LABELS {severity="critical"}
  ANNOTATIONS {
    summary="Disk of {{ $labels.app }} space",
    description="{{ $labels.app }} is below 10% free space for more than 1 minutes.", 
  }

ALERT DiskOutOfInodes
  IF (max(diskstatus_inodesfree / diskstatus_inodestotal)BY (app)) < 0.2
  FOR 1m
  LABELS {severity="warning"}
  ANNOTATIONS {
    summary="Disk of {{ $labels.app }} inodes",
    description="{{ $labels.app }} is below 20% free inodes for more than 1 minutes.", 
  }

ALERT DiskOutOfInodes
  IF (max(diskstatus_inodesfree / diskstatus_inodestotal) BY (app)) < 0.1
  FOR 1m
  LABELS {severity="critical"}
  ANNOTATIONS {
    summary="Disk of {{ $labels.app }} inodes",
    description="{{ $labels.app }} is below 10% free inodes for more than 1 minutes.", 
  }

ALERT BackupMissing
  IF (time() - max(max_over_time(backup_verliernix_last_rsync_backup[1d]))BY (app)) > (60 * 60 * 24 * 2)
  FOR 1m
  LABELS {severity="warning"}
  ANNOTATIONS {
    summary="Backup of {{ $labels.app }} missing",
    description="{{ $labels.app }} has no verliernix backup for more than 2 days", 
  }

ALERT BackupMissing
  IF (time() - max(max_over_time(backup_verliernix_last_rsync_backup[1d]))BY (app)) > (60 * 60 * 24 * 3)
  FOR 1m
  LABELS {severity="critical"}
  ANNOTATIONS {
    summary="Backup of {{ $labels.app }} missing",
    description="{{ $labels.app }} has no verliernix backup for more than 3 days", 
  }

# Alert for any failed HTTP/s Status Codes that that arise for >5 minutes.
ALERT HttpError
  IF probe_success == 0
  FOR 5m
  LABELS { severity = "critical" }
  ANNOTATIONS {
    summary = "Instance {{ $labels.instance }} down",
    description = "{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 5 minutes.",
  }
